import{d as S,k as q,o as i,c as r,e as l,f as h,g as v,v as m,t as n,F as I,n as j,D as w,i as x,w as V,r as d,y as z,l as g}from"./index-BIUjLROW.js";import{g as G}from"./driverColors-pQD1MuRz.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"driver-management"},Q={class:"page-header"},H={class:"search-box"},K={key:0,class:"loading"},P={key:1,class:"error"},R={key:2,class:"empty-state"},W={key:3,class:"drivers-grid"},X={class:"driver-header"},Y={class:"driver-info"},Z={class:"driver-stats"},ee={key:0,class:"driver-color-indicator"},le={class:"color-label"},se={class:"driver-details"},te={class:"detail-item"},oe={class:"value highlight"},ae={class:"detail-item"},ne={class:"value"},ie={class:"detail-item"},re={class:"value"},de={class:"driver-actions"},ue=["onClick"],ce=["onClick"],ve={class:"modal"},me={class:"modal-header"},pe={class:"modal-body"},fe={class:"form-group"},ye={class:"form-group"},be={class:"form-group"},ke={class:"form-group"},ge={class:"color-picker-group"},_e={class:"modal-footer"},De=["disabled"],Ce={class:"modal modal-danger"},he={class:"modal-header"},we={class:"modal-body"},xe={class:"modal-footer"},Me=S({__name:"DriverManagementView",setup(Ne){const _=d([]),D=d(!1),p=d(""),f=d(""),y=d(!1),u=d(!1),c=d(null),b=d(null),o=d({name:"",email:"",nickname:"",color:""}),M=z(()=>{if(!f.value)return _.value;const s=f.value.toLowerCase();return _.value.filter(e=>e.name.toLowerCase().includes(s))});async function C(){var s,e;D.value=!0,p.value="";try{const a=await g.getDrivers();_.value=Array.isArray(a)?a:[]}catch(a){p.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to load drivers"}finally{D.value=!1}}function A(s){c.value=s,o.value={name:s.name,email:s.email||"",nickname:s.nickname||"",color:s.color||N(s.id)},y.value=!0}function N(s){return G(s)}function F(s){b.value=s,u.value=!0}async function $(){var s,e;try{c.value?await g.updateDriver(c.value.id,o.value):await g.createDriver(o.value),await C(),k()}catch(a){alert(((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to save driver")}}async function U(){var s,e;try{await g.deleteDriver(b.value.id),await C(),u.value=!1,b.value=null}catch(a){alert(((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to delete driver")}}function k(){y.value=!1,c.value=null,o.value={name:"",email:"",nickname:"",color:""}}function B(s){return s.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)}function L(s){if(!s)return"N/A";const e=Math.floor(s/60),a=(s%60).toFixed(3);return e>0?`${e}:${a.padStart(6,"0")}`:`${a}s`}function T(s){return s?new Date(s).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"N/A"}return q(()=>{C()}),(s,e)=>{var a;return i(),r("div",O,[l("div",Q,[e[11]||(e[11]=l("div",{class:"header-left"},[l("h1",null,"ðŸ‘¥ Driver Management"),l("p",{class:"subtitle"},"Manage drivers and their profiles")],-1)),l("button",{class:"btn-primary",onClick:e[0]||(e[0]=t=>y.value=!0)},[...e[10]||(e[10]=[l("span",{class:"icon"},"âž•",-1),h(" Add New Driver ",-1)])])]),l("div",H,[e[12]||(e[12]=l("span",{class:"search-icon"},"ðŸ”",-1)),v(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),type:"text",placeholder:"Search drivers...",class:"search-input"},null,512),[[m,f.value]])]),D.value?(i(),r("div",K,[...e[13]||(e[13]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading drivers...",-1)])])):p.value?(i(),r("div",P,n(p.value),1)):M.value.length===0?(i(),r("div",R,[...e[14]||(e[14]=[l("p",null,"ðŸ“­ No drivers found",-1)])])):(i(),r("div",W,[(i(!0),r(I,null,j(M.value,t=>(i(),r("div",{key:t.id,class:"driver-card"},[l("div",X,[l("div",{class:"driver-avatar",style:w({backgroundColor:t.color||N(t.id)})},n(B(t.name)),5),l("div",Y,[l("h3",null,n(t.name),1),l("p",Z,n(t.sessions_count||0)+" sessions â€¢ "+n(t.laps_count||0)+" laps ",1),t.color?(i(),r("div",ee,[l("span",{class:"color-dot",style:w({backgroundColor:t.color})},null,4),l("span",le,n(t.color),1)])):x("",!0)])]),l("div",se,[l("div",te,[e[15]||(e[15]=l("span",{class:"label"},"Best Lap",-1)),l("span",oe,n(L(t.best_lap_time)),1)]),l("div",ae,[e[16]||(e[16]=l("span",{class:"label"},"Best Track",-1)),l("span",ne,n(t.best_track||"N/A"),1)]),l("div",ie,[e[17]||(e[17]=l("span",{class:"label"},"Joined",-1)),l("span",re,n(T(t.created_at)),1)])]),l("div",de,[l("button",{onClick:E=>A(t),class:"btn-edit"}," âœï¸ Edit ",8,ue),l("button",{onClick:E=>F(t),class:"btn-delete"}," ðŸ—‘ï¸ Delete ",8,ce)])]))),128))])),y.value?(i(),r("div",{key:4,class:"modal-overlay",onClick:V(k,["self"])},[l("div",ve,[l("div",me,[l("h2",null,n(c.value?"Edit Driver":"Add New Driver"),1),l("button",{class:"close-btn",onClick:k},"âœ•")]),l("div",pe,[l("div",fe,[e[18]||(e[18]=l("label",null,"Driver Name *",-1)),v(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.name=t),type:"text",placeholder:"Enter driver name",class:"form-input"},null,512),[[m,o.value.name]])]),l("div",ye,[e[19]||(e[19]=l("label",null,"Email",-1)),v(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.email=t),type:"email",placeholder:"driver@email.com",class:"form-input"},null,512),[[m,o.value.email]])]),l("div",be,[e[20]||(e[20]=l("label",null,"Nickname",-1)),v(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.nickname=t),type:"text",placeholder:"Optional nickname",class:"form-input"},null,512),[[m,o.value.nickname]])]),l("div",ke,[e[21]||(e[21]=l("label",null,"Driver Color",-1)),l("div",ge,[v(l("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.color=t),type:"color",class:"color-input"},null,512),[[m,o.value.color]]),v(l("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.color=t),type:"text",placeholder:"#FF6384",class:"form-input color-text"},null,512),[[m,o.value.color]]),l("div",{class:"color-preview",style:w({backgroundColor:o.value.color||"#cccccc"})},null,4)]),e[22]||(e[22]=l("small",{class:"form-hint"},"Choose a unique color for this driver's chart data",-1))])]),l("div",_e,[l("button",{onClick:k,class:"btn-secondary"},"Cancel"),l("button",{onClick:$,class:"btn-primary",disabled:!o.value.name},n(c.value?"Update":"Create"),9,De)])])])):x("",!0),u.value?(i(),r("div",{key:5,class:"modal-overlay",onClick:e[9]||(e[9]=V(t=>u.value=!1,["self"]))},[l("div",Ce,[l("div",he,[e[23]||(e[23]=l("h2",null,"âš ï¸ Confirm Delete",-1)),l("button",{class:"close-btn",onClick:e[7]||(e[7]=t=>u.value=!1)},"âœ•")]),l("div",we,[l("p",null,[e[24]||(e[24]=h("Are you sure you want to delete ",-1)),l("strong",null,n((a=b.value)==null?void 0:a.name),1),e[25]||(e[25]=h("?",-1))]),e[26]||(e[26]=l("p",{class:"warning-text"},"This will also delete all their sessions and laps!",-1))]),l("div",xe,[l("button",{onClick:e[8]||(e[8]=t=>u.value=!1),class:"btn-secondary"},"Cancel"),l("button",{onClick:U,class:"btn-danger"},"Delete")])])])):x("",!0)])}}}),$e=J(Me,[["__scopeId","data-v-83bfcfa9"]]);export{$e as default};
